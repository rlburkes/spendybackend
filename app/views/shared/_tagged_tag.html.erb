<% if params[:tag] %>
  <% tagList = params[:tag].split(',') %>
  <% if tagList.include?(tag.name)%>
    <% tagList.delete(tag.name) %>
  <% else %>
    <% tagList.push(tag.name) %>
  <% end %>
  <%= link_to tag.name, tagged_url(params.merge(:tag => tagList.join(','))), :class => (tagList.include?(tag.name) ? 'btn btn-mini' : 'btn btn-mini btn-info')  %>
<% else %>
  <%= link_to tag.name, tagged_url(params.merge(:tag => tag.name)), :class =>  'btn btn-mini'  %>
<% end %> 
